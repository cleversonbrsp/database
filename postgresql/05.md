Vamos desbloquear o **N√≠vel 5: JSON e Tipos Especiais no PostgreSQL** üßô‚Äç‚ôÇÔ∏è  
Esse √© um diferencial *fort√≠ssimo* do PostgreSQL, que o transforma num banco h√≠brido entre relacional e NoSQL.

---

## üß¨ **N√≠vel 5 ‚Äì JSON e Tipos Especiais**

### üß† **Conceito simples:**
Imagine que voc√™ quer guardar **dados que variam muito de formato**, como um hist√≥rico de batalhas de cada guerreiro ‚Äî o n√∫mero, local, inimigos, resultado etc.

Em vez de criar v√°rias colunas fixas, voc√™ pode guardar **JSON** diretamente no campo!  
Assim, cada guerreiro pode ter um hist√≥rico diferente, e o PostgreSQL ainda permite **consultar dentro do JSON**.

---

### üîç **Tipos que veremos:**
- `JSON` ou `JSONB` ‚Üí para objetos flex√≠veis
- `ARRAY` ‚Üí para listas simples
- `ENUM` ‚Üí para valores fixos como "classe" do guerreiro
- `UUID` ‚Üí identificadores universais √∫nicos

---

## üì¶ **Parte 1: Adicionando um campo JSONB**

```sql
ALTER TABLE guerreiros ADD COLUMN historico JSONB;
```

Vamos inserir dados com JSON direto:

```sql
UPDATE guerreiros
SET historico = '[
  {"batalha": "Drag√£o do Norte", "resultado": "vit√≥ria"},
  {"batalha": "Torre Sombria", "resultado": "derrota"}
]'
WHERE nome = 'Arthas';
```

---

## üîé **Consultando o JSON:**

Pegue todos os guerreiros que tenham uma batalha chamada "Drag√£o do Norte":

```sql
SELECT nome, historico
FROM guerreiros
WHERE historico @> '[{"batalha": "Drag√£o do Norte"}]';
```

---

## üßÆ **Parte 2: Usando ARRAY**

```sql
ALTER TABLE guerreiros ADD COLUMN habilidades TEXT[];
```

Adicionando valores:
```sql
UPDATE guerreiros
SET habilidades = ARRAY['espada', 'arco']
WHERE nome = 'Luna';
```

Consultando:
```sql
SELECT nome FROM guerreiros WHERE 'arco' = ANY(habilidades);
```

---

## üé≠ **Parte 3: ENUM ‚Äì Classes de Guerreiros**

```sql
CREATE TYPE classe_guerreiro AS ENUM ('mago', 'arqueiro', 'paladino');

ALTER TABLE guerreiros ADD COLUMN classe classe_guerreiro;

UPDATE guerreiros SET classe = 'paladino' WHERE nome = 'Luna';
```

---

## üîê **Parte 4: UUID como ID**

```sql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE runas (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  descricao TEXT
);
```

---

## üß™ **Desafio N√≠vel 5 ‚Äì O Livro das Runas**
1. Adicione o campo `historico` (JSONB) em `guerreiros`.
2. Insira um hist√≥rico com 2 batalhas em pelo menos um guerreiro.
3. Crie o campo `habilidades` (ARRAY de texto) e adicione algumas.
4. Crie o ENUM `classe_guerreiro` e associe classes aos guerreiros.
5. Crie a tabela `runas` com UUID e insira 2 registros.
